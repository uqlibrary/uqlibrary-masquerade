<!doctype html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=no">
  <title>uqlibrary-mascquerade</title>

  <script src="../../webcomponentsjs/webcomponents.min.js"></script>
  <script src="../../web-component-tester/browser.js"></script>

  <link rel="import" href="../uqlibrary-masquerade.html">
</head>
<body>

  <uqlibrary-masquerade></uqlibrary-masquerade>

  <script>

    window.addEventListener('polymer-ready', function() {

      var parent = document.querySelector('uqlibrary-masquerade');

      //send keboard event toit'
      function dispatchInputEvent(target) {
        var e = new Event('input', {
          bubbles: true
        });
        target.dispatchEvent(e);
      };

      describe('uqlibrary-masquerade', function () {
        before(function () {

        });

        describe('uqlibrary-hours-list', function () {

          it('should display masquerade title', function (done) {
            setTimeout(function () {
              //check page title
              var pageTitle = parent.shadowRoot.querySelector('#toolbar-page-title').innerHTML;
              expect(pageTitle).to.be.equal('Library masquerade');

              done();

            }, 1000);
          });

          it('should set masquerading user id', function (done) {
            setTimeout(function () {
              var newUserNameInput = parent.shadowRoot.querySelector('#newUserNameInput');
              newUserNameInput.value = "s123123123";
              dispatchInputEvent(newUserNameInput);

              setTimeout(function () {
                expect(parent.getMasqueradeUrl()).to.be.equal('https://www.library.uq.edu.au/uqlais/masquerade?user=s123123123');
                done();
              }, 2000);
            }, 1000);
          });

        });
      });
    });
  </script>

</body>
</html>
